<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Sqoop/HBase Quickstart on Linux - Chase Seibert Blog</title>
<meta name="description" content="Sqoop is a tool for bulk copying data between a relational database like MySQL and HDFS or another Hadoop based data store like Hive or HBase. It can either export a table or set of tables, or you can specify a custom SQL query to pull the data out. It’s the best solution out there for moving massive data sets; it can even fan out sqoop workers to a configurable number of Hadoop data nodes, which will all run partitioned versions of the main SQL query in parallel.">


  <meta name="author" content="Chase Seibert">
  
  <meta property="article:author" content="Chase Seibert">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Chase Seibert Blog">
<meta property="og:title" content="Sqoop/HBase Quickstart on Linux">
<meta property="og:url" content="https://chase-seibert.github.io/blog/2013/06/07/sqoop-quickstart.html">


  <meta property="og:description" content="Sqoop is a tool for bulk copying data between a relational database like MySQL and HDFS or another Hadoop based data store like Hive or HBase. It can either export a table or set of tables, or you can specify a custom SQL query to pull the data out. It’s the best solution out there for moving massive data sets; it can even fan out sqoop workers to a configurable number of Hadoop data nodes, which will all run partitioned versions of the main SQL query in parallel.">





  <meta name="twitter:site" content="@chase_seibert">
  <meta name="twitter:title" content="Sqoop/HBase Quickstart on Linux">
  <meta name="twitter:description" content="Sqoop is a tool for bulk copying data between a relational database like MySQL and HDFS or another Hadoop based data store like Hive or HBase. It can either export a table or set of tables, or you can specify a custom SQL query to pull the data out. It’s the best solution out there for moving massive data sets; it can even fan out sqoop workers to a configurable number of Hadoop data nodes, which will all run partitioned versions of the main SQL query in parallel.">
  <meta name="twitter:url" content="https://chase-seibert.github.io/blog/2013/06/07/sqoop-quickstart.html">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2013-06-07T00:00:00+00:00">






<link rel="canonical" href="https://chase-seibert.github.io/blog/2013/06/07/sqoop-quickstart.html">







  <meta name="google-site-verification" content="KbUN2yK33xTFIQa6xopl2QZyG02prTwsPwnCTjRRYMM" />






<!-- end _includes/seo.html -->



  <link href="/blog/feed.xml" type="application/atom+xml" rel="alternate" title="Chase Seibert Blog Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/blog/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <link rel="icon" href="/blog/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/blog/favicon.ico" type="image/x-icon">
<a rel="me" href="https://hachyderm.io/@chase_seibert"></a>
  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/blog/">
          Chase Seibert Blog
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/blog/me/"
                
                
              >Top Posts</a>
            </li><li class="masthead__menu-item">
              <a
                href="/blog/reading-list/"
                
                
              >Reading List</a>
            </li><li class="masthead__menu-item">
              <a
                href="/blog/resume.pdf"
                
                
              >Resume</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://chase-seibert.github.io/blog/">
        <img src="/blog/images/chase-square.jpg" alt="Chase Seibert" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://chase-seibert.github.io/blog/" itemprop="url">Chase Seibert</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Director of Engineering at Dropbox</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">San Francisco, CA</span>
        </li>
      

      
        
          
            <li><a href="https://www.facebook.com/chase.seibert" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i><span class="label">Facebook</span></a></li>
          
        
          
            <li><a href="https://github.com/chase-seibert" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.goodreads.com/chaseseibert" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-goodreads" aria-hidden="true"></i><span class="label">Goodreads</span></a></li>
          
        
          
            <li><a href="https://letterboxd.com/quasigenx/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-film" aria-hidden="true"></i><span class="label">Letterboxd</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/chaseseibert/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://hachyderm.io/@chase_seibert" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-mastodon" aria-hidden="true"></i><span class="label">Mastodon</span></a></li>
          
        
          
            <li><a href="https://stackoverflow.com/users/7679" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i><span class="label">Stack Overflow</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Sqoop/HBase Quickstart on Linux">
    <meta itemprop="description" content="Sqoop is a tool for bulk copying data between a relational database like MySQL and HDFS or another Hadoop based data store like Hive or HBase. It can either export a table or set of tables, or you can specify a custom SQL query to pull the data out. It’s the best solution out there for moving massive data sets; it can even fan out sqoop workers to a configurable number of Hadoop data nodes, which will all run partitioned versions of the main SQL query in parallel.">
    <meta itemprop="datePublished" content="2013-06-07T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://chase-seibert.github.io/blog/2013/06/07/sqoop-quickstart.html" itemprop="url">Sqoop/HBase Quickstart on Linux
</a>
          </h1>
          


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p><a href="http://sqoop.apache.org/">Sqoop</a> is a tool for bulk copying data between a relational database like MySQL and HDFS or another Hadoop based data store like Hive or HBase. It can either export a table or set of tables, or you can specify a custom SQL query to pull the data out. It’s the best solution out there for moving massive data sets; it can even fan out sqoop workers to a configurable number of Hadoop data nodes, which will all run partitioned versions of the main SQL query in parallel.</p>

<h1 id="install">Install</h1>

<p>To get started, you will need to install Sqoop. The easiest method on Linux is to use the <a href="http://www.cloudera.com/content/cloudera-content/cloudera-docs/CDH4/latest/CDH4-Installation-Guide/CDH4-Installation-Guide.html">Cloudera</a> repository. You will also need the JDBC MySQL driver, and the JDK (Sqoop compiles a JAR on the fly and sends it out as a MapReduce job).</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cat</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh"> &gt;&gt; /etc/apt/sources.list.d/cloudera.list
deb [arch=amd64] http://archive.cloudera.com/cdh4/ubuntu/precise/amd64/cdh precise-cdh4 contrib
deb-src http://archive.cloudera.com/cdh4/ubuntu/precise/amd64/cdh precise-cdh4 contrib
</span><span class="no">EOF
</span>curl <span class="nt">-s</span> http://archive.cloudera.com/cdh4/ubuntu/lucid/amd64/cdh/archive.key| <span class="nb">sudo </span>apt-key add -
<span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get <span class="nb">install </span>sqoop libmysql-java openjdk-7-jdk</code></pre></figure>

<h1 id="run-it">Run it!</h1>

<p>Say you have a MySQL table <code class="language-plaintext highlighter-rouge">user</code> and a HBase table with the same name. If you want to do a straight copy of the data and use the <code class="language-plaintext highlighter-rouge">id</code> column as the HBase rowkey and store all the columns in a HBase column family named <code class="language-plaintext highlighter-rouge">data</code>, all you need to do is:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sqoop-import <span class="nt">--connect</span> jdbc:mysql://<span class="nv">$MYSQL_SERVER</span>/<span class="nv">$DATABASE</span> <span class="nt">--driver</span> com.mysql.jdbc.Driver <span class="nt">--username</span> <span class="nv">$USER</span> <span class="nt">--password</span> <span class="nv">$PASSWORD</span> <span class="nt">--table</span> user <span class="nt">--hbase-table</span> user <span class="nt">--hbase-row-key</span> <span class="nb">id</span> <span class="nt">--column-family</span> data</code></pre></figure>

<p>At least for HBase, you are almost always want to compose some more sophisticated rowkey, to avoid <a href="http://my.safaribooksonline.com/book/databases/database-design/9781449314682/optimizing-splits-and-compactions/id3163684">region hotspotting</a>. If you can express that rowkey as a SQL statement, you’re good to go. Instead of <code class="language-plaintext highlighter-rouge">--table</code>, you specify a <code class="language-plaintext highlighter-rouge">--query</code>, and change the column referenced in <code class="language-plaintext highlighter-rouge">--hbase-row-key</code>.</p>

<p>Say we want the rowkey to be the first five characters of the md5 hash of the <code class="language-plaintext highlighter-rouge">company_id</code> field in the <code class="language-plaintext highlighter-rouge">user</code> table, plus the <code class="language-plaintext highlighter-rouge">date_added</code> field formatted as an eight character string, plus the <code class="language-plaintext highlighter-rouge">id</code> field. Example: <code class="language-plaintext highlighter-rouge">a8f5c-20130101-47</code>.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sqoop-import <span class="nt">--connect</span> jdbc:mysql://<span class="nv">$MYSQL_SERVER</span>/<span class="nv">$DATABASE</span> <span class="nt">--driver</span> com.mysql.jdbc.Driver <span class="nt">--username</span> <span class="nv">$USER</span> <span class="nt">--password</span> <span class="nv">$PASSWORD</span> <span class="nt">--hbase-table</span> user <span class="nt">--hbase-row-key</span> <span class="nb">id</span> <span class="nt">--column-family</span> data <span class="nt">--query</span> <span class="s2">"SELECT  CONCAT_WS('-', SUBSTR(MD5(a.company_id), 1, 5), DATE_FORMAT(a.date_added, '%Y%m%d'), a.id) as rowkey, a.* FROM user a WHERE </span><span class="se">\$</span><span class="s2">CONDITIONS"</span></code></pre></figure>

<p><em>Note: the <code class="language-plaintext highlighter-rouge">$CONDITIONS</code> is a placeholder for the dynamic partitioning of data across server. You may also need to specify a <code class="language-plaintext highlighter-rouge">--split-by</code> column.</em></p>

<h1 id="tuning">Tuning</h1>

<p>For a large number of rows, you may find that Sqoop is using a lot of memory to copy the data over. You may even run into a <code class="language-plaintext highlighter-rouge">java.lang.OutOfMemoryError: Java heap space</code> or a <code class="language-plaintext highlighter-rouge">java.lang.OutOfMemoryError: GC overhead limit exceeded</code>. If you do, it’s likely because the MySQL database driver is fetching all of the rows of the table, and keeping them in memory. You can tell it to chunk up the query into pages and use a cursor by changing the connect string to: <code class="language-plaintext highlighter-rouge">mysql://$MYSQL_SERVER/$DATABASE?dontTrackOpenResources=true\&amp;defaultFetchSize=1000\&amp;useCursorFetch=true</code>. See the <a href="http://dev.mysql.com/doc/refman/5.1/en/connector-j-reference-configuration-properties.html">documentation</a>.</p>

<h1 id="trouble-shooting">Trouble-shooting</h1>

<p>If you get an error saying that sqoop cannot load the MySQL driver, you may need to do a manual <code class="language-plaintext highlighter-rouge">sudo cp /usr/share/java/mysql.jar /usr/lib/sqoop/lib</code> to copy it to the right place.</p>

<p>If you get the error <code class="language-plaintext highlighter-rouge">0000-00-00 00:00:00' can not be represented as java.sql.Timestamp</code>, you should modify your connect string to add the <code class="language-plaintext highlighter-rouge">zeroDateTimeBehavior</code> flag, ie <code class="language-plaintext highlighter-rouge">mysql://$MYSQL_SERVER/$DATABASE?zeroDateTimeBehavior=convertToNull</code></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/blog/tags/#hadoop" class="page__taxonomy-item p-category" rel="tag">hadoop</a><span class="sep">, </span>
    
      <a href="/blog/tags/#hbase" class="page__taxonomy-item p-category" rel="tag">hbase</a><span class="sep">, </span>
    
      <a href="/blog/tags/#sqoop" class="page__taxonomy-item p-category" rel="tag">sqoop</a>
    
    </span>
  </p>






    <p class="page__date">
        <strong><i class="fas fa-fw fa-edit" aria-hidden="true"></i> GitHub:</strong>
        <a href="https://github.com/chase-seibert/blog/blob/master/_posts/2013-06-07-sqoop-quickstart.md">_posts/2013-06-07-sqoop-quickstart.md</a>
    </p>

        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2013-06-07T00:00:00+00:00">June 7, 2013</time></p>

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/blog/2013/05/24/why-you-should-not-write-your-own-load-balancer.html" class="pagination--pager" title="High availability via client libraries versus dedicated services">Previous</a>
    
    
      <a href="/blog/2013/06/21/hadoop-from-a-python-perspective.html" class="pagination--pager" title="Hadoop from a Python Perspective">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
</div>

      
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    
      <li><a href="/blog/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 <a href="https://chase-seibert.github.io">Chase Seibert Blog</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/blog/assets/js/main.min.js"></script>









  </body>
</html>
